scale_color_brewer(palette = "Paired")+
theme_bw()
b231_desc1 <- read_csv("resultats/bouss_prof/b231_desc1.csv")
b231_desc1 <- read_csv("resultats/bouss_prof/b231_desc1.csv")
b231 <- dplyr::select(b231_desc1, pres, fluo_440, fluo_470, fluo_532) %>% na.omit() %>% mutate(depth = round(pres)) %>%
mutate(f470_f440 = fluo_470/fluo_440,
f532_f440 = fluo_532/fluo_440,
f532_f470 = fluo_532/fluo_470) %>%
group_by(depth) %>%
summarise_all(mean) %>%
ungroup()
b231_test <- b231 %>%
dplyr::select(f470_f440, f532_f440, f532_f470)
pred229 <- predict(mlda, newdata= b231_test)
b231$taxa <- pred229$class
b231_prob <- data.frame(pred229$posterior) %>% mutate(depth = b231$depth) %>%
pivot_longer(1:5, names_to = "taxa", values_to = "probability") %>%
group_by(depth) %>%
summarise(m = max(probability)) %>%
pull(m)
b231$prob <- b231_prob
ggplot(b231)+
geom_point(aes(x = fluo_470*0.007, y = - depth, colour = taxa, size = prob))+
xlab("Chla concentration (ug.L-1)")+
ylab("Depth")+
ylim(-250,0)+
xlim(0,1.1)+
scale_colour_brewer(palette = "Set1")+
ggtitle("Boussole 229 (April)")+
theme_bw()
b231_fluo <- dplyr::select(b231, depth, fluo_440, fluo_470, fluo_532) %>% pivot_longer(2:4, names_to = "Wavelength", values_to = "Counts")
ggplot(b231_fluo)+
geom_point(aes(x = Counts, y = - depth, colour = Wavelength))+
scale_color_brewer(palette = "Paired")+
theme_bw()
ggplot(b231_fluo)+
geom_point(aes(x = (Counts - 50) * 0.007, y = - depth, colour = Wavelength))+
scale_color_brewer(palette = "Paired")+
ylab("Fluo Chl")+
ylim(-100, 0)+
theme_bw()
ggplot(b231_fluo)+
geom_point(aes(x = (Counts - 50) * 0.007, y = - depth, colour = Wavelength))+
scale_color_brewer(palette = "Paired")+
xlab("Fluo Chl")+
ylim(-100, 0)+
theme_bw()
ggplot(b231)+
geom_point(aes(x = fluo_470*0.007, y = - depth, colour = taxa, size = prob))+
xlab("Chla concentration (ug.L-1)")+
ylab("Depth")+
ylim(-250,0)+
xlim(0,1.1)+
scale_colour_brewer(palette = "Set1")+
ggtitle("Boussole 229 (April)")+
theme_bw()
library(tidyverse)
library(scales)
results <- read_csv("resultats/results_reshape.csv") %>% rename("f440_mean" = "440nm_mean", "f470_mean" = "470nm_mean", "f532_mean" = "532nm_mean")
library(tidyverse)
library(scales)
results <- read_csv("/resultats/results_reshape.csv") %>% rename("f440_mean" = "440nm_mean", "f470_mean" = "470nm_mean", "f532_mean" = "532nm_mean")
library(tidyverse)
library(scales)
results <- read_csv("resultats/results_reshape.csv") %>% rename("f440_mean" = "440nm_mean", "f470_mean" = "470nm_mean", "f532_mean" = "532nm_mean")
library(tidyverse)
library(scales)
results <- read_csv("resultats/results_reshape.csv") %>% rename("f440_mean" = "440nm_mean", "f470_mean" = "470nm_mean", "f532_mean" = "532nm_mean")
results_with_hplc <- filter(results, chla_qa != 'NA')
results_chla <- results_with_hplc %>% dplyr::select(strain ,dilution, replicate, chla_conc_spectro, total_chlorophyll_a) %>%
pivot_longer(4:5, names_to = 'chla', values_to = 'concentration') %>% filter(dilution %in% c('2', 'Cmere'))
ggplot(results_with_hplc)+
geom_point(aes(x = total_chlorophyll_a, y = chla_conc_spectro, colour = strain))+
geom_smooth(aes(x = total_chlorophyll_a, y = chla_conc_spectro), method = 'lm', se = FALSE)+
ylab("Chla spectro")+
xlab("Chla HPLC")+
ggtitle("Rsq = 0.94")+
theme_bw()+
scale_x_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x))) +
scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x))) +
scale_color_brewer(name = "Souches", palette = "Paired")
View(results_with_hplc)
View(results)
View(results_with_hplc)
library(tidyverse)
library(scales)
results <- read_csv("resultats/results_reshape.csv") %>% rename("f440_mean" = "440nm_mean", "f470_mean" = "470nm_mean", "f532_mean" = "532nm_mean")
results_with_hplc <- filter(results, chla_qa != 'NA')
results_chla <- results_with_hplc %>% dplyr::select(strain ,dilution, replicate, chla_conc_spectro, total_chlorophyll_a) %>%
pivot_longer(4:5, names_to = 'chla', values_to = 'concentration') %>% filter(dilution %in% c('2', 'Cmere'))
ggplot(results_with_hplc)+
geom_point(aes(x = total_chlorophyll_a, y = chla_conc_spectro, colour = strain))+
geom_smooth(aes(x = total_chlorophyll_a, y = chla_conc_spectro), method = 'lm', se = FALSE)+
ylab("Chla spectro")+
xlab("Chla HPLC")+
ggtitle("Rsq = 0.94")+
theme_bw()+
scale_x_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x))) +
scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x))) +
scale_color_brewer(name = "Souches", palette = "Paired")
View(results)
library(tidyverse)
library(MASS)
results <- read_csv("resultats/results_reshape.csv") %>% rename("f440_mean" = "440nm_mean", "f470_mean" = "470nm_mean", "f532_mean" = "532nm_mean")
colnames(results)
results_with_hplc <- filter(results, chla_qa != 'NA')
results_chla <- results_with_hplc %>% dplyr::select(strain ,dilution, replicate, chla_conc_spectro, total_chlorophyll_a) %>%
pivot_longer(4:5, names_to = 'chla', values_to = 'concentration') %>% filter(dilution %in% c('2', 'Cmere'))
ggplot(results_chla)+
geom_bar(aes(x = replicate, y = concentration, fill = chla), stat = 'identity', position = 'dodge')+
facet_grid(dilution~strain, scale = 'free')
ggplot(results_with_hplc)+
geom_point(aes(x = log(total_chlorophyll_a), y = log(chla_conc_spectro), colour = strain))+
geom_smooth(aes(x = log(total_chlorophyll_a), y = log(chla_conc_spectro)), method = 'lm', se = FALSE)+
ylab("Chla spectro")+
xlab("Chla HPLC")+
theme_bw()+
scale_color_brewer(name = "Souches", palette = "Paired")
model <- lm(log(total_chlorophyll_a)~log(chla_conc_spectro), data = results_with_hplc)
summary(model)
result <- results_with_hplc %>% mutate(chl_content = total_chlorophyll_a/number_cells,
f440_content = f440_mean/number_cells,
f470_content = f470_mean/number_cells,
f532_content = f532_mean/number_cells,
f440_f470 = f440_mean/f470_mean,
f440_f532 = f440_mean/f532_mean,
f532_f440 = f532_mean/f440_mean,
f470_f440 = f470_mean/f440_mean,
f532_f470 = f532_mean/f470_mean,
f440_ratio = f440_mean/total_chlorophyll_a,
f470_ratio = f470_mean/total_chlorophyll_a,
f532_ratio = f532_mean/total_chlorophyll_a,
d470_d440 = f470_ratio/f440_ratio,
d532_d440 = f532_ratio/f440_ratio)
ggplot(result)+
geom_boxplot(aes(x = strain, y = log(chl_content)))
ggplot(result)+
geom_point(aes(x = log(f440_content), y = log(chl_content)))
ggplot(result)+
geom_point(aes(x = d532_d440, y = d470_d440, colour = strain))
result <- result %>% mutate(common_name = case_when(
strain %in% c("RCC1717", "RCC76", "RCC4213") ~ "Diatom",
strain %in% c("RCC162", "RCC156", "PCC9511") ~ "Prochlorococcus",
strain %in% c("RCC2379", "RCC2374", "RCC2319") ~ "Synechococcus",
strain %in% c("RCC100") ~ "Pelagophyte",
strain %in% c("RCC3006") ~ "Dino"
))
ggplot(result)+
geom_point(aes(x = d532_d440, y = d470_d440, colour = common_name))
xtrain <- dplyr::select(result, f470_f440, f532_f440, f532_f470)
ytrain <- pull(result, common_name)
DTrain <- result %>% filter(dilution != "Cmere") %>% dplyr::select(common_name, f470_f440, f532_f440, f532_f470)
training.samples <- caret::createDataPartition(DTrain$common_name, p = 0.67, list = FALSE)
train.data  <- DTrain[training.samples, ]
test.data <- DTrain[-training.samples, ] %>% dplyr::select(-common_name)
ytest <- DTrain[-training.samples, ] %>% pull(common_name)
mlda <- lda(common_name ~ ., data = train.data)
print(mlda)
predTest <- predict(mlda,newdata=test.data)
mc <- table(ytest, predTest$class)
print(mc)
ytest <- c()
prediction <- c()
for(i in c(1:10000)){
training.samples <- caret::createDataPartition(DTrain$common_name, p = 0.8, list = FALSE)
training.samples <- sample(nrow(DTrain), 31)
train.data  <- DTrain[training.samples, ]
test.data <- DTrain[-training.samples, ] %>% dplyr::select(-common_name)
ytest <- c(ytest, DTrain[-training.samples,]$common_name)
mlda <- lda(common_name ~ ., data = train.data)
predTest <- predict(mlda, newdata=test.data)
predicted <- as.character(predTest$class)
prediction <- c(prediction, predicted)
}
mc <- table(ytest, prediction)
print(mc)
result_pred <- data.frame("real" = ytest, "predict" = prediction) %>%
mutate("classification" = case_when(
real == predict ~ "ok",
real != predict ~ "nok"
)) %>%
group_by(real, classification) %>%
summarise(n = n()) %>%
mutate(percent = n/sum(n) * 100)
ggplot(result_pred)+
geom_bar(aes(x = real, y = percent, fill = classification), stat = "identity")+
theme_bw()+
scale_fill_brewer(palette = "Set1")
ggplot(result)+
geom_point(aes(x = d532_d440, y = d470_d440, colour = common_name))
ggplot(result)+
geom_point(aes(x = d532_d440, y = d470_d440, colour = common_name))+
xlab("F532/F440")+
ylab("F470/F440")+
theme_bw(base_size = 18)+
scale_colour_brewer(palette = "Dark1")
ggplot(result)+
geom_point(aes(x = d532_d440, y = d470_d440, colour = common_name))+
xlab("F532/F440")+
ylab("F470/F440")+
theme_bw(base_size = 18)+
scale_colour_brewer(palette = "accent")
ggplot(result)+
geom_point(aes(x = d532_d440, y = d470_d440, colour = common_name))+
xlab("F532/F440")+
ylab("F470/F440")+
theme_bw(base_size = 18)+
scale_colour_brewer(palette = "Accent")
ggplot(result)+
geom_point(aes(x = d532_d440, y = d470_d440, colour = common_name), size = 2)+
xlab("F532/F440")+
ylab("F470/F440")+
theme_bw(base_size = 18)+
scale_colour_brewer(palette = "Accent")
ggplot(result)+
geom_point(aes(x = d532_d440, y = d470_d440, colour = common_name), size = 4)+
xlab("F532/F440")+
ylab("F470/F440")+
theme_bw(base_size = 18)+
scale_colour_brewer(palette = "Accent")
ggplot(result)+
geom_point(aes(x = d532_d440, y = d470_d440, colour = common_name), size = 4)+
xlab("F532/F440")+
ylab("F470/F440")+
theme_bw(base_size = 18)+
scale_colour_brewer(palette = "Paired")
ggplot(result)+
geom_point(aes(x = d532_d440, y = d470_d440, colour = common_name), size = 4)+
xlab("F532/F440")+
ylab("F470/F440")+
theme_bw(base_size = 18)+
scale_colour_brewer(palette = "Paired", name = "Groupe taxo")
ggsave("output/ratio.png", width = 12, height = 8)
ggsave("projet_3x1m/output/ratio.png", width = 12, height = 8)
ggplot(result)+
geom_point(aes(x = d532_d440, y = d470_d440, colour = common_name), size = 4)+
xlab("F532/F440")+
ylab("F470/F440")+
theme_bw(base_size = 18)+
scale_colour_brewer(palette = "Set1", name = "Groupe taxo")
ggplot(result)+
geom_point(aes(x = d532_d440, y = d470_d440, colour = common_name), size = 4)+
xlab("F532/F440")+
ylab("F470/F440")+
theme_bw(base_size = 18)+
scale_colour_brewer(palette = "Set2", name = "Groupe taxo")
ggplot(result)+
geom_point(aes(x = d532_d440, y = d470_d440, colour = common_name), size = 4)+
xlab("F532/F440")+
ylab("F470/F440")+
theme_bw(base_size = 18)+
scale_colour_brewer(palette = "Set1", name = "Groupe taxo")
ggsave("projet_3x1m/output/ratio.png", width = 12, height = 8)
library(tidyverse)
library(MASS)
results <- read_csv("resultats/results_reshape.csv") %>% rename("f440_mean" = "440nm_mean", "f470_mean" = "470nm_mean", "f532_mean" = "532nm_mean")
colnames(results)
results_with_hplc <- filter(results, chla_qa != 'NA')
results_chla <- results_with_hplc %>% dplyr::select(strain ,dilution, replicate, chla_conc_spectro, total_chlorophyll_a) %>%
pivot_longer(4:5, names_to = 'chla', values_to = 'concentration') %>% filter(dilution %in% c('2', 'Cmere'))
ggplot(results_chla)+
geom_bar(aes(x = replicate, y = concentration, fill = chla), stat = 'identity', position = 'dodge')+
facet_grid(dilution~strain, scale = 'free')
ggplot(results_with_hplc)+
geom_point(aes(x = log(total_chlorophyll_a), y = log(chla_conc_spectro), colour = strain))+
geom_smooth(aes(x = log(total_chlorophyll_a), y = log(chla_conc_spectro)), method = 'lm', se = FALSE)+
ylab("Chla spectro")+
xlab("Chla HPLC")+
theme_bw()+
scale_color_brewer(name = "Souches", palette = "Paired")
model <- lm(log(total_chlorophyll_a)~log(chla_conc_spectro), data = results_with_hplc)
summary(model)
result <- results_with_hplc %>% mutate(chl_content = total_chlorophyll_a/number_cells,
f440_content = f440_mean/number_cells,
f470_content = f470_mean/number_cells,
f532_content = f532_mean/number_cells,
f440_f470 = f440_mean/f470_mean,
f440_f532 = f440_mean/f532_mean,
f532_f440 = f532_mean/f440_mean,
f470_f440 = f470_mean/f440_mean,
f532_f470 = f532_mean/f470_mean,
f440_ratio = f440_mean/total_chlorophyll_a,
f470_ratio = f470_mean/total_chlorophyll_a,
f532_ratio = f532_mean/total_chlorophyll_a,
d470_d440 = f470_ratio/f440_ratio,
d532_d440 = f532_ratio/f440_ratio)
ggplot(result)+
geom_boxplot(aes(x = strain, y = log(chl_content)))
ggplot(result)+
geom_point(aes(x = log(f440_content), y = log(chl_content)))
ggplot(result)+
geom_point(aes(x = d532_d440, y = d470_d440, colour = strain))
result <- result %>% mutate(common_name = case_when(
strain %in% c("RCC1717", "RCC76", "RCC4213") ~ "Diatom",
strain %in% c("RCC162", "RCC156", "PCC9511") ~ "Prochlorococcus",
strain %in% c("RCC2379", "RCC2374", "RCC2319") ~ "Synechococcus",
strain %in% c("RCC100") ~ "Pelagophyte",
strain %in% c("RCC3006") ~ "Dino"
))
ggplot(result)+
geom_point(aes(x = d532_d440, y = d470_d440, colour = common_name), size = 4)+
xlab("F532/F440")+
ylab("F470/F440")+
theme_bw(base_size = 18)+
scale_colour_brewer(palette = "Set1", name = "Groupe taxo")
ggsave("projet_3x1m/output/ratio.png", width = 12, height = 8)
xtrain <- dplyr::select(result, f470_f440, f532_f440, f532_f470)
ytrain <- pull(result, common_name)
DTrain <- result %>% filter(dilution != "Cmere") %>% dplyr::select(common_name, f470_f440, f532_f440, f532_f470)
training.samples <- caret::createDataPartition(DTrain$common_name, p = 0.67, list = FALSE)
train.data  <- DTrain[training.samples, ]
test.data <- DTrain[-training.samples, ] %>% dplyr::select(-common_name)
ytest <- DTrain[-training.samples, ] %>% pull(common_name)
mlda <- lda(common_name ~ ., data = train.data)
print(mlda)
predTest <- predict(mlda,newdata=test.data)
mc <- table(ytest, predTest$class)
print(mc)
ytest <- c()
prediction <- c()
for(i in c(1:10000)){
training.samples <- caret::createDataPartition(DTrain$common_name, p = 0.8, list = FALSE)
training.samples <- sample(nrow(DTrain), 31)
train.data  <- DTrain[training.samples, ]
test.data <- DTrain[-training.samples, ] %>% dplyr::select(-common_name)
ytest <- c(ytest, DTrain[-training.samples,]$common_name)
mlda <- lda(common_name ~ ., data = train.data)
predTest <- predict(mlda, newdata=test.data)
predicted <- as.character(predTest$class)
prediction <- c(prediction, predicted)
}
mc <- table(ytest, prediction)
print(mc)
result_pred <- data.frame("real" = ytest, "predict" = prediction) %>%
mutate("classification" = case_when(
real == predict ~ "ok",
real != predict ~ "nok"
)) %>%
group_by(real, classification) %>%
summarise(n = n()) %>%
mutate(percent = n/sum(n) * 100)
ggplot(result_pred)+
geom_bar(aes(x = real, y = percent, fill = classification), stat = "identity")+
theme_bw()+
scale_fill_brewer(palette = "Set1")
# test on boussole data ---------------------------------------------------
b229_desc2 <- read_csv("resultats/bouss_prof/b229_desc2.csv")
b229_desc3 <- read_csv("resultats/bouss_prof/b229_desc3.csv")
b227_desc2 <- read_csv("resultats/bouss_prof/b227_desc2.csv")
b229 <- dplyr::select(b229_desc2, pres, fluo_440, fluo_470, fluo_532) %>% na.omit() %>% mutate(depth = round(pres)) %>%
mutate(f470_f440 = fluo_470/fluo_440,
f532_f440 = fluo_532/fluo_440,
f532_f470 = fluo_532/fluo_470) %>%
group_by(depth) %>%
summarise_all(mean) %>%
ungroup()
b229_3 <- dplyr::select(b229_desc3, pres, fluo_440, fluo_470, fluo_532) %>% na.omit() %>% mutate(depth = round(pres)) %>%
mutate(f470_f440 = fluo_470/fluo_440,
f532_f440 = fluo_532/fluo_440,
f532_f470 = fluo_532/fluo_470) %>%
group_by(depth) %>%
summarise_all(mean) %>%
ungroup()
b227 <- dplyr::select(b227_desc2, pres, fluo_440, fluo_470, fluo_532) %>% na.omit() %>% mutate(depth = round(pres)) %>%
group_by(depth) %>%
mutate(f470_f440 = fluo_470/fluo_440,
f532_f440 = fluo_532/fluo_440,
f532_f470 = fluo_532/fluo_470) %>%
summarise_all(mean) %>%
ungroup() %>%
mutate(prof = "b227")
b229_test <- b229 %>%
dplyr::select(f470_f440, f532_f440, f532_f470)
b229_3_test <- b229_3 %>%
dplyr::select(f470_f440, f532_f440, f532_f470)
test2 <- b227 %>%
dplyr::select(f470_f440, f532_f440, f532_f470)
mlda <- lda(common_name~., data = DTrain)
pred229 <- predict(mlda, newdata= b229_test)
pred229_3 <- predict(mlda, newdata= b229_3_test)
pred227 <- predict(mlda, newdata = test2)
b229$taxa <- pred229$class
b229_3$taxa <- pred229_3$class
b227$taxa <- pred227$class
b227_prob <- data.frame(pred227$posterior) %>% mutate(depth = b227$depth) %>%
pivot_longer(1:5, names_to = "taxa", values_to = "probability") %>%
group_by(depth) %>%
summarise(m = max(probability)) %>%
pull(m)
b227$prob <- b227_prob
b229_prob <- data.frame(pred229$posterior) %>% mutate(depth = b229$depth) %>%
pivot_longer(1:5, names_to = "taxa", values_to = "probability") %>%
group_by(depth) %>%
summarise(m = max(probability)) %>%
pull(m)
b229$prob <- b229_prob
b229_3_prob <- data.frame(pred229_3$posterior) %>% mutate(depth = b229_3$depth) %>%
pivot_longer(1:5, names_to = "taxa", values_to = "probability") %>%
group_by(depth) %>%
summarise(m = max(probability)) %>%
pull(m)
b229_3$prob <- b229_3_prob
ggplot(b229)+
geom_point(aes(x = fluo_470, y = - depth, colour = taxa, size = prob))+
ylim(-200,0)
ggplot(b229_3)+
geom_point(aes(x = fluo_470, y = - depth, colour = taxa, size = prob))+
ylim(-200,0)+
xlim(0,200)
ggplot(b227)+
geom_point(aes(x = fluo_470, y = - depth, colour = taxa, size = prob))+
ylim(-250,0)+
xlim(50,150)
ggplot(b227)+
geom_point(aes(x = f532_f440, y = f470_f440, colour = taxa))
ggplot(b229)+
geom_point(aes(x = f532_f440, y = f470_f440, colour = taxa, size = prob))
ggplot(b229_3)+
geom_point(aes(x = f532_f440, y = f470_f440, colour = taxa, size = prob))
ggplot(b227)+
geom_point(aes(x = fluo_470, y = - depth, colour = taxa, size = prob))+
ylim(-250,0)+
xlim(50,150)
ggplot(b229_3)+
geom_point(aes(x = fluo_470, y = - depth, colour = taxa, size = prob))+
ylim(-200,0)+
xlim(0,200)
ggplot(b229)+
geom_point(aes(x = fluo_470, y = - depth, colour = taxa, size = prob))+
ylim(-200,0)
ggplot(b229)+
geom_point(aes(x = fluo_470, y = - depth, colour = taxa, size = prob))+
ylim(-200,0)
ggplot(b229)+
geom_point(aes(x = fluo_470, y = - depth, colour = taxa, size = prob))+
ylim(-100,0)
ggplot(b229)+
geom_point(aes(x = fluo_470, y = - depth, colour = taxa, size = prob))+
ylim(-100,0)+
xlim(0,175)
ggplot(b229)+
geom_point(aes(x = fluo_470, y = - depth, colour = taxa))+
ylim(-100,0)+
xlim(0,175)
ggplot(b229)+
geom_point(aes(x = fluo_470, y = - depth, colour = taxa), size = 4)+
ylim(-100,0)+
xlim(0,175)
ggplot(b229_3)+
geom_point(aes(x = fluo_470, y = - depth, colour = taxa, size = prob))+
ylim(-200,0)+
xlim(0,200)
ggplot(b227)+
geom_point(aes(x = fluo_470, y = - depth, colour = taxa, size = prob))+
ylim(-250,0)+
xlim(50,150)
ggplot(b227)+
geom_point(aes(x = fluo_470, y = - depth, colour = taxa))+
ylim(-250,0)+
xlim(50,150)
ggplot(b227)+
geom_point(aes(x = fluo_470, y = - depth, colour = taxa), size = 4)+
ylim(-250,0)+
xlim(50,150)
ggplot(b227)+
geom_point(aes(x = fluo_470, y = - depth, colour = taxa), size = 4)+
ylim(-100,0)+
xlim(50,150)
ggplot(b229)+
geom_point(aes(x = fluo_470, y = - depth, colour = taxa), size = 4)+
ylim(-100,0)+
xlim(50,175)
ggplot(b227)+
geom_point(aes(x = fluo_470, y = - depth, colour = taxa), size = 4)+
ylim(-100,0)+
xlim(50,150)
ggplot(b229)+
geom_point(aes(x = fluo_470, y = - depth, colour = taxa), size = 4)+
ylim(-100,0)+
xlim(50,175)+
ggtitle("BOUSSOLE AVRIL")
ggplot(b229)+
geom_point(aes(x = fluo_470, y = - depth, colour = taxa), size = 4)+
ylim(-100,0)+
xlim(50,175)+
ggtitle("BOUSSOLE Avril")+
theme_bw(base_size = 18)
ggplot(b227)+
geom_point(aes(x = fluo_470, y = - depth, colour = taxa), size = 4)+
ylim(-100,0)+
xlim(50,150)+
ggtitle("BOUSSOLE Février")+
theme_bw(base_size = 18)
ggsave("projet_3x1m/output/b229_lda.png", width = 8, height = 12)
ggplot(b229)+
geom_point(aes(x = fluo_470, y = - depth, colour = taxa), size = 4)+
ylim(-100,0)+
xlim(50,175)+
ggtitle("BOUSSOLE Avril")+
theme_bw(base_size = 18)
ggsave("projet_3x1m/output/b229_lda.png", width = 8, height = 12)
ggplot(b227)+
geom_point(aes(x = fluo_470, y = - depth, colour = taxa), size = 4)+
ylim(-100,0)+
xlim(50,150)+
ggtitle("BOUSSOLE Février")+
theme_bw(base_size = 18)
ggsave("projet_3x1m/output/b227_lda.png", width = 8, height = 12)
